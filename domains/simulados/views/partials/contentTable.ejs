<!-- Inputs ocultos -->
<input type="hidden" name="simuladoId" value="<%= simulado.id_simulado %>">
<input type="hidden" name="selectedQuestionIds" id="selectedQuestionIds">

<!-- Container da tabela -->
<div class="table-container">
  <div class="table-responsive">
    <table class="table table-striped table-bordered align-middle mb-0" aria-describedby="descricao-tabela">
      <caption id="descricao-tabela" class="visually-hidden">
        Lista de questões disponíveis para associação ao simulado
      </caption>
      <thead class="table-light">
        <tr>
          <th scope="col" width="5%">
            <div class="form-check">
              <input type="checkbox" id="select-all" class="form-check-input">
              <label for="select-all" class="form-check-label">
                <span class="visually-hidden">Selecionar todas as questões</span>
                Todas
              </label>
            </div>
          </th>
          <th scope="col">Título</th>
          <th scope="col" width="12%">Tipo</th>
          <th scope="col" width="45%">Questão</th>
          <th scope="col" width="15%">Tópico(s)</th>
        </tr>
      </thead>
      <tbody id="questoes-tbody">
        <% questoes.forEach((questao, index) => { 
             const uid = (questao.id ?? questao.id_questao ?? index);
             const valorId = (questao.id ?? questao.id_questao ?? uid);
        %>
          <tr>
            <!-- Checkbox com rótulo visível e acessível -->
            <td>
              <div class="form-check">
                <input 
                  type="checkbox" 
                  id="questao-<%= uid %>" 
                  name="selectedQuestionIds[]" 
                  class="form-check-input questao-checkbox" 
                  value="<%= valorId %>">
                <label for="questao-<%= uid %>" class="form-check-label">
                  <span class="visually-hidden">Selecionar </span>
                  <%= questao.titulo || `Questão ${uid}` %>
                </label>
              </div>
            </td>

            <!-- Título como cabeçalho da linha -->
            <th scope="row" id="title-<%= uid %>">
              <%= questao.titulo || `Questão ${uid}` %>
            </th>

            <!-- Tipo com fallback acessível -->
            <td><%= questao.tipo || 'Tipo não informado' %></td>

            <!-- Texto da questão com fallback -->
            <td><%= questao.texto || questao.enunciado || 'Texto não disponível' %></td>

            <!-- Tópicos com fallback -->
            <td>
              <% const topicosArr = questao.topicos || questao.Topico || []; %>
              <% if (Array.isArray(topicosArr) && topicosArr.length) { %>
                <% topicosArr.forEach((t) => { %>
                  <span class="badge bg-secondary"><%= (t.nome ?? t) %></span>
                <% }) %>
              <% } else { %>
                <span class="text-muted">Sem tópico</span>
              <% } %>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>

<!-- Paginação acessível -->
<nav id="pagination-container" class="pagination-custom" role="navigation" aria-label="Paginação de questões">
  <!-- Links de paginação serão gerados dinamicamente -->
</nav>



